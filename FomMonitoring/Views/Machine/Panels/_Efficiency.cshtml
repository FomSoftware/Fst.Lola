@model FomMonitoringBLL.ViewModel.EfficiencyViewModel
@using FomMonitoringResources

<div id="CardEfficiency" class="portlet">
    <div class="portlet-title">
        <div class="portlet-kpi" v-cloak>
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x" v-bind:class="colorKPI"></i>
                <i class="fa icofom-efficiency fa-stack-1x fa-inverse"></i>
            </span>
        </div>
        <div class="title-kpi" v-cloak>
            <span>@Resource.Efficiency</span>
            <div class="sub-period js-period"></div>
            <div class="sub-period js-historical-period" style="display: none;"></div>
        </div>
        <div class="portlet-details" v-show="showDetails">
            <div class="dropdown" onclick="SharedManager.handlerDropdown($(this))">
                <div class="button drop-btn"><i class="icon-options-vertical"></i></div>
                <div class="dropdown-content right">
                    <div class="dd-item active slide-dashboard" data-group="efficiency">
                        <i class="fa fa-dashboard"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="dd-item slide-history" data-group="efficiency" v-show="show.historical">
                        <i class="fa fa-history"></i>
                        <span>@Resource.Historical</span>
                    </div>
                    <div class="dd-item slide-operator" data-group="efficiency" v-show="show.operators">
                        <i class="fa fa-user"></i>
                        <span>@Resource.Operators</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="portlet-body border-panel" v-bind:class="colorKPI">
        <div class="card-portlet card-efficiency" style="padding: 5px 10px;" v-cloak>
            <div class="swiper-container efficiency">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide">
                            <div class="row" v-if="states != null">
                                <div class="col-12 col-sm-3 col-md-4 col-lg-4">
                                    <div class="row">
                                        <div class="col-6 col-sm-12 col-md-12 col-lg-12 col-xl-12 order-2 order-sm-1 order-md-1 order-lg-1 order-xl-1">
                                            <div id="efc_kpi_chart">
                                            </div>
                                        </div>

                                        <div class="col-6 col-sm-12 col-md-12 col-lg-12 col-xl-12 order-1 order-sm-2 order-md-2 order-lg-2 order-xl-2">
                                            <div id="efc_pie_chart">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div v-bind:class="getCol">
                                    <!-- MACHINE STATES -->
                                    <div class="use-states">
                                        <div class="progress-label clearfix">
                                            <div class="progress-title">
                                                @Resource.MachineStates
                                            </div>
                                            <div class="progress-time">
                                                <div class="icon fa fa-clock-o"></div>
                                                <div>
                                                    <div class="title-time">@Resource.TimeOn</div>
                                                    <div class="value-time">
                                                        <time-span v-bind:duration="total.on"></time-span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <hr />
                                        <table class="table-legend">
                                            <tbody>
                                                <tr v-for="state in states">
                                                    <td>
                                                        <span class="fa-stack">
                                                            <i class="fa fa-square fa-stack-2x" v-bind:class="'cr-' + state.code"></i>
                                                            <i class="fa fa-stack-1x fa-inverse" v-bind:class="icon(state)"></i>
                                                        </span>
                                                        <span class="icon-label font-small">
                                                            {{ state.text }}
                                                            <i v-if="state.active" class="fa fa-check-circle"></i>
                                                        </span>
                                                    </td>
                                                    <td>
                                                        {{ state.perc | round }}<em>%</em>
                                                    </td>
                                                    <td>
                                                        <time-span v-bind:duration="state.time"></time-span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>

                                    </div>
                                </div>
                                <div class="col-1 no-padding-left text-center" v-show="type != '@enMachineType.Troncatrice.GetDescription()'">
                                    <!-- OVERFEED -->
                                    <div class="overfeed">
                                        <div class="overfeed-progress">
                                            <div class="overfeed-title">
                                                overfeed <b>{{ overfeed.value | round }}<em>%</em></b>
                                            </div>
                                            <div class="overfeed-bar" v-bind:class="bgOverfeed" v-bind:aria-valuenow="overfeed.value"></div>
                                            <div class="overfeed-threshold" v-bind:style="{ bottom: overfeed.threshold.green + '%'}"></div>
                                            <div class="overfeed-threshold" v-bind:style="{ bottom: overfeed.threshold.yellow + '%'}"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <no-data v-else></no-data>
                        </div>
                        <div class="swiper-slide">
                            <div id="efc_historical_chart"></div>
                            <no-data v-if="!show.historical"></no-data>
                        </div>
                        <div class="swiper-slide">
                            <div id="efc_operators_chart"></div>
                            <no-data v-if="!show.operators"></no-data>
                        </div>
                    </div>
                </div>
        </div>
    </div>
</div>


<script type="text/javascript">

    $(document).ready(function ()
    {
        var loc = {
            efficiency : '@Resource.Efficiency'
        };
        var data = @Html.Raw(Json.Encode(Model));
        Efficiency.init(data, loc);
    });

</script>